@model ControlIndex

@{
    ViewData["Title"] = "Control Panel";
}

<div class="d-flex flex-column flex-md-row flex-grow-1 justify-content-between">
    <div class="d-flex p-3 align-self-center">
        <h1>Control Panel</h1>
    </div>
    <div class="d-flex p-3 align-self-center">
        Welcome, @Model.UserFirstName
    </div>
</div>

<div class="container bg-secondary rounded-3 border bg-light overflow-hidden">
    <div class="d-none d-md-flex row row-cols-4 text-decoration-none text-white fw-bold bg-gradient bg-dark">
        <div class="col p-3">
            Unit Name
        </div>
        <div class="col p-3 text-center">
            Unit Status
        </div>
        <div class="col p-3 text-center">
            Unit Temperature (&degF)
        </div>
        <div class="col p-3 text-center">
            Fan Status
        </div>
    </div>
    @foreach(UnitBrief u in Model.Units)
    {
        var statusmodifier = "";
        var statusicon = "";
        var statustext = "";
        switch (u.UnitStatus)
        {
            case Shared.Status.CLOSED:
                statusmodifier = "text-success";
                statusicon = "bi-lock-fill";
                statustext = "SECURED";
                break;
            case Shared.Status.AUTO_OPENED:
                statusmodifier = "text-danger";
                statusicon = "bi-exclamation-circle-fill";
                statustext = "AUTO OPENED";
                break;
            case Shared.Status.MAN_OPENED:
                statusmodifier = "text-warning";
                statusicon = "bi-unlock-fill";
                statustext = "OPENED";
                break;
            case Shared.Status.OFFLINE:
                statusmodifier = "text-muted";
                statusicon = "bi-question-circle-fill";
                statustext = "OFFLINE";
                break;
            default:
                statusmodifier = "text-warning";
                statusicon = "bi-exclamation-circle-fill";
                statustext = "ERROR";
                break;
        }

        var tempmodifier = "";
        var tempicon = "bi-thermometer-low";
        var temptext = "-";

        var fanmodifier = "";
        var fanicon = "bi-stop-circle";
        var fantext = "-";

        if(u.UnitStatus != Shared.Status.OFFLINE)
        {
                temptext = @u.Temperature + "&degF";
                if (u.Temperature > 100)
            {
                tempmodifier = "text-danger fw-bold";
                tempicon = "bi-thermometer-high";
            }
            else if (u.Temperature > 80)
            {
                tempmodifier = "text-warning";
                tempicon = "bi-thermometer-half";
            }
            if (u.FanStatus)
            {
                fanmodifier = "text-warning";
                fanicon = "bi-fan";
                fantext = "Running";
            }    
            else
            {
                fantext = "Idle";
            }
        }
        <a class="row text-decoration-none text-dark fw-bold border-top bg-gradient p-3 p-md-1 align-content-center" href="#">
            <div class="col mb-0 p-2 p-md-3 d-flex justify-content-start h4">
                @u.Name
            </div>

            <div class="col d-flex flex-row justify-content-end justify-content-md-center align-items-center">
                <div class="d-flex p-2 bg-gradient rounded-pill m-md-1 fw-bold text-center shadow border">
                    <div class="@statusmodifier"><i class="@statusicon"></i> @statustext</div>
                </div>
            </div>

            <hr class="d-md-none my-3" />

            <div class="col d-flex flex-row justify-content-start justify-content-md-center align-items-center">
                <div class="d-flex flex-column">
                    <div class="d-flex d-md-none fw-bold px-2">
                        Temp:
                    </div>
                    <hr class="d-flex d-md-none m-1" />
                    <div class="d-flex px-2 p-md-3 col-md-4 @tempmodifier">
                        <i class="@tempicon"></i><div>@Html.Raw(temptext)</div>
                    </div>
                </div>
            </div>

            <div class="col d-flex flex-row justify-content-end justify-content-md-center align-items-center">
                <div class="d-flex flex-column">
                    <div class="d-flex d-md-none fw-bold px-2">
                        Fan Status:
                    </div>
                    <hr class="d-flex d-md-none m-1" />

                    <div class="d-flex px-2 p-md-3 col-md-4 @fanmodifier">
                        <i class="@fanicon"></i><div class="ps-1">@fantext</div>
                    </div>
                </div>
            </div>


        </a>
    }
</div>

